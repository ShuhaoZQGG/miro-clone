{
  "name": "miro-clone-websocket",
  "description": "WebSocket server for Miro Clone real-time collaboration",
  "build": {
    "builder": "NIXPACKS",
    "buildCommand": "npm ci --production"
  },
  "deploy": {
    "startCommand": "node server/websocket.js",
    "healthcheckPath": "/health",
    "healthcheckTimeout": 30,
    "restartPolicyType": "ON_FAILURE",
    "restartPolicyMaxRetries": 3
  },
  "services": [
    {
      "name": "websocket",
      "image": "node:18-alpine",
      "port": 3001,
      "replicas": 2,
      "env": {
        "NODE_ENV": "production",
        "PORT": "3001",
        "REDIS_URL": "${{REDIS_URL}}",
        "CORS_ORIGIN": "${{FRONTEND_URL}}"
      },
      "resources": {
        "cpu": "0.5",
        "memory": "512Mi"
      },
      "healthcheck": {
        "type": "http",
        "path": "/health",
        "interval": 30,
        "timeout": 10,
        "retries": 3
      }
    }
  ],
  "scaling": {
    "minInstances": 1,
    "maxInstances": 10,
    "targetCPU": 70,
    "targetMemory": 80
  }
}